spring:
  application:
    name: fintech-project

  datasource:
    url: jdbc:h2:mem:fintech
    driver-class-name: org.h2.Driver
    username: sa
    password: password

  h2:
    console:
      enabled: true
      path: /h2-console

  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: create-drop
    show-sql: true
    properties:
      hibernate:
        format_sql: true

server:
  port: 8080

logging:
  level:
    com.vuongnguyen: DEBUG
    org.springframework.web: DEBUG

resilience4j:
  retry:
    instances:
      fetchingBinancePricesRetry:
        max-attempts: 3
        wait-duration: 500ms
        enable-exponential-backoff: true
        exponential-backoff-multiplier: 2
        retry-exceptions:
          - org.springframework.web.client.ResourceAccessException
          - org.springframework.web.client.HttpServerErrorException
        ignore-exceptions:
          - org.springframework.web.client.HttpClientErrorException
      fetchingHoubiPricesRetry:
        max-attempts: 3
        wait-duration: 500ms
        enable-exponential-backoff: true
        exponential-backoff-multiplier: 2
        retry-exceptions:
          - org.springframework.web.client.ResourceAccessException
          - org.springframework.web.client.HttpServerErrorException
        ignore-exceptions:
          - org.springframework.web.client.HttpClientErrorException
      executingUserTrading:
        max-attempts: 3
        wait-duration: 500ms
        exponential-backoff-multiplier: 2
        retry-exceptions:
          - org.springframework.dao.OptimisticLockingFailureException
        ignore-exceptions:
          - com.vuongnguyen.fintech_project.exception.InsufficientBalanceException
          - com.vuongnguyen.fintech_project.exception.PriceNotAvailableException
          - com.vuongnguyen.fintech_project.exception.DuplicateOrderException

  circuitbreaker:
    instances:
      fetchingBinancePricesCircuitBreaker:
        sliding-window-size: 10
        failure-rate-threshold: 50
        wait-duration-in-open-state: 30s
        minimum-number-of-calls: 5
        permitted-number-of-calls-in-half-open-state: 3
      fetchingHoubiPricesCircuitBreaker:
        sliding-window-size: 10
        failure-rate-threshold: 50
        wait-duration-in-open-state: 30s
        minimum-number-of-calls: 5
        permitted-number-of-calls-in-half-open-state: 3

dce:
  binance:
    url: https://api.binance.com/api/v3/ticker/bookTicker
  huobi:
    url: https://api.huobi.pro/market/tickers
